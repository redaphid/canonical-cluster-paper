doc:
  logo: images/interview-icon.png
  title: Written Interview
  miro: https://miro.com/app/board/uXjVMeJA43k=
  repo: https://github.com/redaphid/resume-canonical
  intro: |
    #### Structure of this Document
    When responding to these prompts, I found that answering them in a discrete fashion was not the most effective way to communicate experience and expertise in some technical matters. I have therefore organized some responses into descriptions of concrete solutions in my career that utilize the technologies in question. I provide a detailed description porkbarreled in to answering the questions as I encounter them, and refer to these descriptions in subsequent prompts. I have also included some diagrams to help visualize the concepts I am trying to communicate.

    I hope this format makes sense to you, though I imagine I won't be able to clarify anything, due to the anonymity of this process.
  main:
    - title: Identity and Authorization Technology
      prompts:
      - prompt: Describe your experience with authorization systems, specifically Open Policy Agent and OAuth.
        answers:
        - response: |
            I have extensive, varied experience when it comes to authorization and authentication systems.
            I will give some brief bullet points of my experiences over time with various authorization systems, and then I will give some more detailed examples of my experience with Open Policy Agent and OAuth.

            * The earliest "exotic" auth system I encountered in my career was a strange one called [OACC](http://oaccframework.org). It is a open-source system created by a colleague, and I remember it to be something like RBAC, with some permission delegation mechanism.

            * Next, I worked for Unicon and used [Shiboboleth](https://www.shibboleth.net/) (a SAML-based identity provider)

            * After this, I began work on the open-source Internet of Things platform "Meshblu", and the closed source application that ran on top of it called "Octoblu". Octoblu was later acquired by Citrix.

            #### Experience with Meshblu
            Meshblu is capable of configuring and messaging hardware or software "devices" hardware being things like hue bulbs, or DIY Arduino projects, and software being things like web applications. My team inherited Meshblu with a [permission system](https://meshblu.readme.io/reference/whitelists) that was baked directly in to the json document that represented the configuration of the device. This system was a simple one - arrays of concrete uuids that are allowed to perform certain actions. It was only capable of dealing with concrete entities - no roles, groups, etc. My colleagues and I eventually replaced it with a [more flexible system](https://meshblu.readme.io/reference/whitelists-2-0) that is still very simple and easy to understand.

            In short, it is a 2-dimensional "permission matrix", where the first dimension is the actions that can be taken on a device {broadcast, discover, configure, message}, and the second dimension usually has 2-3 permissions that were relevant to the action domain. Critically, we added an 'as' permission, allowed for impersonation, which makes groups possible without being baked in to the system.

            On top of this, we have many microservices that exist in "userland" with respect to Meshblu; they services could implement different authorization systems on top of Meshblu if necessary or desired. For example, we had a microservice that translated between OAuth and our permission system.

            We had many authn/authz systems of our own to do this permission translation. For example, a microcontroller may need to authenticate via MQTT, the protocol it is using to communicate with Meshblu. Often communications happened over http, and we allowed for basic auth if necessary. Since we had many protocols, I ended up having doing this translation a lot.

            We had many microservices that would "assume the identity" of a device, and bridge the gap between Meshblu and other services, which often required the use of OAuth. In some cases, I remember having to do the "OAuth handshake" between 4 different oauth providers (including at least 1 of ours). It will take me a while to remember the details of this, and I'm trying not to get *too* rambly for the sake of those having to read this :)

            #### The "Totally Naive Services" cluster & Open Policy Agent experience

            I later designed an experimental cluster to be used in environments with complex and unknown-to-us security requirements, potentially including governmental or military applications. The cluster would be deployed in both single-tenant, on-prem environments and multitenant cloud environments. The cluster design factored out multitenancy with respect to the services it contained; e.g. the underlying services did not have a concept of organizations, or really even users (from a security standpoint). I used Open Policy Agent to the point of absurdity when it came to this cluster design, with the expectation that we'd eventually hit a wall of impracticality after which the services inside the cluster would have to become more complex as they became more aware of their environment.

            This approach to cluster development allowed us to build the cluster in parallel to the teams developing the services, and the development roadmaps of these services could be organized such that there was no wasted code if some of the more novel ideas did not work out.

            _aside: I wrote a wrote a Javascript poc that used OPA's ability to return a partially-solved abstract syntax tree from a policy, and then execute it using function composition with [Ramda](https://ramdajs.com/). Should you do this? No. But it was interesting!_

            #### Cluster Design from a Security Standpoint
            Seeing how I now have a captive audience (dear reader), I'll use the cluster as an object lesson in how I design things when in "Research and Development mode", while minimizing risk during the development of production code.
            I am recalling this from memory, and recreating the diagrams, so I may be wrong about some of the details.

            One of the goals of this architecture was to separate all authentication and authorization concerns from the services themselves, and end up with a "naive service", which I will here define as:

            1. trusts that actions requested to be performed on a resource are allowed.
            1. trusts that any information requested is allowed to be returned.

        - response: |
            At the highest level, the cluster is divided into 3 concentric circles of trust:

        - response: |
            1. No trust (outside world)
            1. Authentication trust (within cluster)
            1. Authorization trust. "Naive" (within pod)

          figure:
            figure: naive-cluster-overview
            miro: '3458764548628056239'

        - response: |
            The barriers between these circles were enforced by OPA.
            Outside of the authentication barrier, we are in a no-trust environment.
            Once we pass through the authentication barrier, communications between the services can trust that the request was from who it says it is.
        - response: |
            #### Authentication Barrier
            An OPA service was installed before Envoy at the ingress gateway of the cluster. OPA would evaluate the request after obtaining information necessary to reason about authentication legitimacy. This information could be provided as a result of an OIDC workflow, some kind of Active Directory authentication, or a variety of other authorization methods we supported via an adapter pattern described later on in this document. This policy could also be a passthrough, and assume whatever security handshake that happened earlier in the request flow validated user identity correctly.

            _note: the authorization data in the diagram is separated logically from the request, but the information in practice would likely come from the request._
          figure:
            figure: authentication-barrier
            miro: '3458764548747400083'
        - response: |
            #### Authentication Workflow
            This workflow diagram llustrates the flow of data through the authentication barrier. Note the 'Envoy' nodes represent the same Envoy service on the edge of the cluster.

          figure:
            figure: authentication-workflow
            miro: '3458764548844659047'

        - response: |
            In the proof of concept, I used Envoy to insert an "Identity" header into the request after the request was validated through whatever mechanism the client wanted to use. We offered a Keycloak instance as an IdP with OIDC capabilities, but we also would accept OIDC credentials from a trusted 3rd party; or many other authentication mechanisms - we followed an adapter pattern for normalizing auth requirements and data, which I'll talk about a little bit later on.

            Regardless of the mechanism used, in the end an OPA policy always gated access to the cluster. The client's authentication data was evaluated against OPA policies, which had the final say. This, like all autoinjected systems in the cluster, could be opted out of via configuration.

            This implementation, however, has a potential vulnerability in that we would need to scrub an "Identity" header off of the incoming request. Since all requests were coming in through the ingress controller that Envoy was manipulating the headers from, in theory this wouldn't be a problem - but I would have rather encapsulated the request in an envelope larger than the request itself. I had learned with Meshblu that separation between data and metadata is very important, especially with regard to security.

            In addition, this header could be manipulated by a malicious service within the cluster. The header solution was good enough for a proof of concept, but further research would be needed to create an envelope for the request that sufficiently separated "userland" requests and cluster metadata. Anyway, that's a mini self-audit of this implementation.

            Past this barrier, the services could trust that the request was from who it said it was, but they could not (yet) trust that the request was authorized to do what it was trying to do.

        - response: |
            #### Authorization Barrier
            After the authentication barrier is passed, any subsequent OPA policy evaluation can assume that the identity presented to the policy for evaluation is accurate, which allows for simple, decoupled policies to govern authorization on a per-service pod basis. You may notice below the similarity between the cluster-protecting authentication barrier, and this authorization barrier.

        - response: |
            An OPA service was injected into each Kubernetes pod, layered above Envoy. Work was being done on embedding OPA as a plugin to Envoy (also injected by default in Istio).
            Also by default, the OPA service would only do the authorization gating on ingress traffic - though evolutions of this design allowed for OPA to filter egress traffic as well. But we'll get to that later.
          figure:
            figure: authorization-barrier
            miro: '3458764548747400083'
        - response: |
            #### Authorization Workflow
            This diagram shows the flow of data through the authorization barrier. Note that all 'Envoy' elements in the diagram are the same service.


            At this point, the request is coming from inside the cluster, with the rewritten identity header.
          figure:
            figure: authorization-workflow
            miro: '3458764548844659047'

        - response: |
            Past this point, we have what I'd consider "half" of a naive service: the service can trust that actions requested to be performed on a resource are allowed. If this is as far as I could take the cluster, it still provides a lot of value. But the service still needs to do some logic as to what a particular user can see, which is unsatisfying. But let's take a little break from these barriers, go depth-first, and talk about the origin of the authz/n information.

        - response: |
            #### Authorization Adapters
            One of the goals of the cluster experiment was to support existing security infrastructure transparently. OPA was used as the only gate for both trust boundaries, but the clients may need information from their existing IdP (identity provider) in order to reason about access control. This entails using data or existing rules from Active Directory, Okta, or various other IdPs within the logic of a policy.

        - response: |
           I accomplished this by making several microservices that used the adapter pattern to ETL (extract,transform,load) any information necessary for policy evaluation from various IdPs to OPA's internal, ephermal datastore.

            I preferred this method to OPA policies doing http requests to our adapters, as I feel doing http requests and parsing the results make policies much more difficult to understand, as the policy now has to know and deal with implementation details, which defeats the purpose of having a restricted policy language.

          figure:
            figure: identity-provider-data-to-opa
            miro: '3458764548738949056'

        - response: |
            #### Authorization and Authentication Egress Filters
            You may have noticed an asymmetry in the [authorization barrier](#authorization-barrier). While the request to perform an action is gated by an OPA policy, the response (egress from the pod) is not; as a result, a service within a pod has to make assumptions regarding the security model.


      - prompt: Describe your experience integrating OpenID Connect providers or using OpenID Connect libraries in your projects.
        answers:
        - response: |
            I both consumed OIDC responses, and run Keycloak as an OIDC provider in the cluster described above. Besides that, I can't think offhand of other work I've done regarding OIDC except to study the workflow in order to build the cluster.
      - prompt: Describe your experience with container technologies such as Docker, LXD and Kubernetes.
        answers:
        - response: |
            sdadasd
    - title: General Software Engineering Experience
      prompts:
      - prompt: What kinds of software projects have you worked on before? Which operating systems, development environments, languages, databases?
      - prompt: Would you describe yourself as a high quality coder? Why?
      - prompt:  Would you describe yourself as an architect of resilient software? If so, why, and in which sorts of applications?
      - prompt:  What is your most senior role in a software engineering organisation? Describe your span of control, and the diversity of products, functions and teams you led.
      - prompt: What is your proudest success as an engineering leader?
      - prompt: Outline your thoughts on open source software development. What is important to get right in open source projects? What open source projects have you worked on? Have you been an open source maintainer, on which projects, and what was your role?
      - prompt: Describe your experience building large systems with many services - web front ends, REST APIs, data stores, event processing and other kinds of integration between components. What are the key things to think about in regard to architecture, maintainability, and reliability in these large systems?
      - prompt:  How comprehensive would you say your knowledge of a Linux distribution is, from the kernel up? How familiar are you with low-level system architecture, runtimes and Linux distro packaging? How have you gained this knowledge?
      - prompt: Describe your experience with large-scale IT operations, SAAS, or other running services, in a devops or IS or system administration capacity
      - prompt: Describe your experience with public cloud based operations - how well do you understand large-scale public cloud estate management and developer experience?
      - prompt: Describe your experience with enterprise infrastructure and application management, either as a user running enterprise operations, or as a vendor targeting the enterprise market
      - prompt: Outline your thoughts on quality in software development. What practices are most effective to drive improvements in quality?
      - prompt: Outline your thoughts on documentation in large software projects. What practices should teams follow? What are great examples of open source docs?
      - prompt: Outline your thoughts on user experience, usability and design in software. How do you lead teams to deliver outstanding user experience?
      - prompt: Outline your thoughts on performance in software engineering. How do you ensure that your product is fast?
      - prompt: Outline your thoughts on security in software engineering. How do you lead your engineers to improve their security posture and awareness?
      - prompt: Outline your thoughts on devops and devsecops. Which practices are effective, and which are overrated?
    - title: Industry leadership experience
      prompts:
      - prompt: Describe your speaking experience at industry events and conferences
      - prompt: Are you a thought leader in any particular area of technology?
      - prompt: Describe any experience working with startups. What did you draw from that experience that would be relevant for this application?
      - prompt: Describe any experience working in a public company. What is important for your colleagues to know about being a public company?
    - title: Education
      prompts:
      - prompt: How did you fare in high school mathematics, physical sciences and computing? Which were strengths and which most enjoyable? How did you rank, competitively, in them?
      - prompt: What sort of high school student were you? Outside of class, what were your interests and hobbies?  What would your high school peers remember you for, if we asked them?
      - prompt: In languages and the arts at high school, what were your strongest subjects and how did you rank in those among your school peers?
      - prompt: Describe some high school achievements considered exceptional by peers and staff
      - prompt: Which degree and university did you choose, and why?
      - prompt: Which university courses did you perform best at? How did you rank in your degree?
      - prompt: Outside of class, what were your interests and where did you spend your time?
      - prompt: What did you achieve at university that you consider exceptional?
      - prompt: At high school or university, what leadership roles did you take on?
    - title: Context
      prompts:
        - prompt: Outline your thoughts on the mission of Canonical. What is it about the company's purpose and goals which is most appealing to you? What do you see as risky or unappealing?
        - prompt: Who are Canonical's key competitors, and how should Canonical set about winning?
        - prompt: Why do you most want to work for Canonical?
        - prompt: What would you most want to change about Canonical?
        - prompt: What gets you most excited about this role?
